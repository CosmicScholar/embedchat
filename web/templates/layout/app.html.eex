<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title><%= gettext "Lewini Live Chat: A Live Chat Software for Business!" %></title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.cyan-blue.min.css" />
    <link rel="stylesheet" href="<%= static_path(@conn, "/css/app.css") %>">
    <!-- start Mixpanel -->
    <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
       for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
     mixpanel.init("426ecf95068c318c25f7aa80ab5b8541");
     mixpanel.track("Page view");
    </script>
    <!-- end Mixpanel -->
  </head>

  <body>
    <!-- Always shows a header, even in smaller screens. -->
    <!-- <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"> -->
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span class="mdl-layout-title">Lewini</span>
          <!-- Add spacer, to align navigation to the right -->
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation -->
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <%= link gettext("Home"),    to: page_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= if @current_user do %>
              <%= link gettext("Setup"), to: room_path(@conn, :index), class: "mdl-navigation__link" %>
              <%= link gettext("Logout"), to: session_path(@conn, :delete, @current_user), method: :delete, class: "mdl-navigation__link" %>
            <% else %>
              <%= link gettext("Price"),    to: page_path(@conn, :price), class: "mdl-navigation__link" %>
              <%= link gettext("Login"),    to: session_path(@conn, :new), class: "mdl-navigation__link" %>
              <%= link gettext("Register"), to: user_path(@conn, :new), class: "mdl-navigation__link" %>
            <% end %>
            <!-- Right aligned menu below button -->
            <button id="menu-lower-right"
              class="mdl-button mdl-js-button mdl-button--icon">
              <i class="material-icons">more_vert</i>
            </button>

            <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
              for="menu-lower-right">
              <li class="mdl-menu__item">
                <%= link gettext("English"), to: current_locale_path(@conn, "en"), class: "mdl-button mdl-js-button" %>
              </li>
              <li class="mdl-menu__item">
                <%= link gettext("Japanese"), to: current_locale_path(@conn, "ja"), class: "mdl-button mdl-js-button" %>
              </li>
            </ul>
          </nav>
        </div>
      </header>
      <div class="mdl-layout__drawer">
        <%= if @current_user do %>
          <span class="mdl-layout-title">
            <%= @current_user.email %>
          </span>
          <nav class="mdl-navigation">
            <%= link gettext("Home"),         to: page_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Chat"),         to: page_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Messages"),     to: message_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Auto Message"), to: auto_message_config_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Setup"),        to: room_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Logout"),       to: session_path(@conn, :delete, @current_user), method: :delete, class: "mdl-navigation__link" %>
          </nav>
        <% else %>
          <span class="mdl-layout-title">
            Lewini
          </span>
          <nav class="mdl-navigation">
            <%= link gettext("Home"),     to: page_path(@conn, :index), class: "mdl-navigation__link" %>
            <%= link gettext("Price"),    to: page_path(@conn, :price), class: "mdl-navigation__link" %>
            <%= link gettext("Login"),    to: session_path(@conn, :new), class: "mdl-navigation__link" %>
            <%= link gettext("Register"), to: user_path(@conn, :new), class: "mdl-navigation__link" %>
          </nav>
        <% end %>
      </div>
      <main class="mdl-layout__content">
        <div class="page-content">
          <!-- Your content goes here -->
          <%= if get_flash(@conn, :info) || get_flash(@conn, :error) do %>
            <center>
              <p>
                <p class="alert alert-info" role="alert"><%= get_flash(@conn, :info) %></p>
                <p class="alert alert-danger" role="alert"><%= get_flash(@conn, :error) %></p>
              </p>
            </center>
          <% end %>
          <%= render @view_module, @view_template, assigns %>
        </div>
      </main>
    </div>

    <%= if !@current_user && !Enum.member?(@conn.path_info, 'room') do %>
      <div data-id="<%= @conn.assigns[:chat_id] %>" id="lewini-chat"></div>
    <% end %>
    <script>window.userToken = "<%= assigns[:user_token] %>"</script>
    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <script src="<%= static_path(@conn, "/js/app.js") %>"></script>
  </body>
</html>
